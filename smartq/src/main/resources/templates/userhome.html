<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Patient Dashboard | SmartQ</title>

	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
		rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

	<style>
		:root {
			--primary-color: #0d9488;
			--primary-dark: #0f766e;
			--secondary-bg: #f0fdfa;
			--text-dark: #1e293b;
			--text-light: #64748b;
			/* Gradient Backgrounds */
			--teal-bg-start: #f0fdfa;
			--teal-bg-end: #ccfbf1;
		}

		body {
			font-family: 'Poppins', sans-serif;
			background: linear-gradient(135deg, var(--teal-bg-start) 0%, var(--teal-bg-end) 100%);
			min-height: 100vh;
			background-attachment: fixed;
		}

		/* --- UPDATED NAVBAR STYLING --- */
		.navbar {
			background: var(--primary-color);
			box-shadow: 0 4px 20px rgba(13, 148, 136, 0.2);
			padding: 1rem 2rem;
		}

		.navbar-brand {
			font-weight: 700;
			color: #ffffff !important;
			font-size: 1.5rem;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.nav-user-text {
			color: rgba(255, 255, 255, 0.9);
			font-weight: 500;
		}

		.btn-nav-light {
			background: rgba(255, 255, 255, 0.15);
			color: white;
			border: 1px solid rgba(255, 255, 255, 0.3);
			backdrop-filter: blur(5px);
			transition: all 0.2s;
		}

		.btn-nav-light:hover {
			background: white;
			color: var(--primary-color);
		}

		.btn-nav-logout {
			background: #ef4444;
			color: white;
			border: none;
			transition: all 0.2s;
		}

		.btn-nav-logout:hover {
			background: #dc2626;
			transform: translateY(-1px);
		}

		/* Cards */
		.doctor-card {
			background: white;
			border-radius: 16px;
			border: none;
			padding: 2rem;
			height: 100%;
			box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
			transition: all 0.3s ease;
			position: relative;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
		}

		.doctor-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
		}

		/* Avatar */
		.doctor-avatar {
			width: 80px;
			height: 80px;
			background: var(--secondary-bg);
			color: var(--primary-color);
			font-size: 2rem;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 0 auto 1.5rem auto;
			border: 3px solid white;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
		}

		/* Status Badges */
		.status-badge {
			font-size: 0.85rem;
			padding: 0.4rem 1rem;
			border-radius: 50px;
			font-weight: 500;
			display: inline-flex;
			align-items: center;
			width: fit-content;
			margin: 0 auto;
		}

		.status-available {
			background-color: #dcfce7;
			color: #15803d;
			border: 1px solid #86efac;
		}

		.status-busy {
			background-color: #fee2e2;
			color: #b91c1c;
			border: 1px solid #fca5a5;
		}

		.dot {
			width: 8px;
			height: 8px;
			border-radius: 50%;
			display: inline-block;
			margin-right: 6px;
		}

		.dot-green {
			background-color: #15803d;
		}

		.dot-red {
			background-color: #b91c1c;
		}

		/* Buttons */
		.btn-token {
			background-color: var(--primary-color);
			border: none;
			border-radius: 50px;
			padding: 0.75rem 1.5rem;
			font-weight: 600;
			width: 100%;
			transition: all 0.2s;
			color: white;
		}

		.btn-token:hover {
			background-color: var(--primary-dark);
			transform: translateY(-1px);
		}

		.btn-token:disabled {
			background-color: #cbd5e1;
			cursor: not-allowed;
			transform: none;
		}

		.doc-name {
			color: var(--text-dark);
			font-weight: 700;
			margin-bottom: 0.2rem;
		}

		.doc-spec {
			color: var(--text-light);
			font-weight: 400;
			font-size: 0.9rem;
		}
	</style>
</head>

<body>

	<nav class="navbar fixed-top">
		<div class="container">
			<a class="navbar-brand" href="#">
				<i class="fas fa-bed me-2"></i>SmartQ <span class="fw-light opacity-75 fs-6">Patient Portal</span>
			</a>

			<div class="d-flex align-items-center">
				<span class="me-3 nav-user-text d-none d-md-block">
					<i class="fas fa-user-circle me-1 opacity-75"></i>
					Hello, <span th:text="${username}">User</span>
				</span>

				<a th:href="@{/user/insurance(userId=${userId}, status='UPDATE')}"
					class="btn btn-nav-light btn-sm rounded-pill px-3 me-2" title="My Insurance">
					<i class="fas fa-file-medical"></i> Insurance
				</a>

				<a th:href="@{/user/editprofile(userId=${userId})}"
					class="btn btn-nav-light btn-sm rounded-pill px-3 me-2" title="Edit Profile">
					<i class="fas fa-cog"></i> Profile
				</a>

				<a href="/user/userlogin" class="btn btn-nav-logout btn-sm rounded-pill px-3">
					<i class="fas fa-sign-out-alt me-1"></i> Logout
				</a>
			</div>
		</div>
	</nav>

	<div class="container" style="margin-top: 100px; margin-bottom: 50px;">

		<div class="row mb-5 text-center">
			<div class="col-lg-8 mx-auto">
				<h2 class="fw-bold" style="color: var(--text-dark);">Find a Doctor</h2>
				<p class="text-secondary">Select a doctor below to join their live consultation queue.</p>
			</div>
		</div>

		<div class="row g-4">
			<div class="col-md-6 col-lg-4" th:each="doc : ${doctors}">
				<div class="doctor-card">

					<div class="text-center">
						<div class="doctor-avatar">
							<i class="fas fa-user-md"></i>
						</div>

						<h4 class="doc-name" th:text="'Dr. ' + ${doc.username}">Dr. Name</h4>
						<span class="badge bg-light text-dark border rounded-pill mb-3"
							th:text="${doc.specialization}">Specialization</span>

						<div class="mb-4">
							<div th:if="${doc.status.name() == 'AVAILABLE'}" class="status-badge status-available">
								<span class="dot dot-green"></span> Available
							</div>
							<div th:unless="${doc.status.name() == 'AVAILABLE'}" class="status-badge status-busy">
								<span class="dot dot-red"></span> Not Available
							</div>
						</div>
					</div>

					<div class="mt-auto">
						<div class="d-flex align-items-center justify-content-center text-muted small mb-4">
							<i class="fas fa-envelope me-2"></i>
							<span th:text="${doc.email}">email@example.com</span>
						</div>

						<form th:action="@{/user/joinQueue}" method="post">
							<input type="hidden" name="userId" th:value="${userId}" />
							<input type="hidden" name="doctorId" th:value="${doc.id}" />

							<button type="submit" class="btn btn-token"
								th:disabled="${doc.status.name() == 'NOT_AVAILABLE'}">
								<span th:if="${doc.status.name() == 'AVAILABLE'}">Get Token & Join Queue</span>
								<span th:unless="${doc.status.name() == 'AVAILABLE'}">Currently Offline</span>
							</button>
						</form>
					</div>

				</div>
			</div>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>